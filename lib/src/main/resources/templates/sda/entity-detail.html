<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" th:replace="~{sda/base :: layout(~{::body})}">
<body>
<div class="pb-6">
    <h2 class="text-xl font-semibold pb-4 sticky top-0 bg-gray-50 z-10 pt-6">
        <a th:href="${basePath}" class="text-blue-600 hover:underline">Entities</a>
        <span class="text-gray-400">/</span>
        <a th:href="${basePath + '/' + descriptor.entityName}" class="text-blue-600 hover:underline"
           th:text="${descriptor.displayName}">Entity</a>
        <span class="text-gray-400">/</span>
        <span class="text-gray-900" th:text="${id}">id</span>
    </h2>

    <div class="bg-white rounded-lg shadow border border-gray-200">
        <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
            <div class="font-semibold">Details</div>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <tbody class="divide-y divide-gray-100">
                <tr th:each="attr, iStat : ${attributes}" class="hover:bg-gray-50">
                    <th class="w-64 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        th:text="${attr}">Attribute
                    </th>
                    <td class="px-4 py-3 text-sm text-gray-800">
                        <a th:if="${links != null and links[iStat.index] != null and links[iStat.index] != ''}"
                           th:href="${links[iStat.index]}"
                           class="text-blue-700 hover:underline"
                           th:text="${values[iStat.index]}">Linked</a>
                        <span th:if="${links == null or links[iStat.index] == null or links[iStat.index] == ''}"
                              th:text="${values[iStat.index]} ?: '—'">Value</span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Relations: collection associations as tables -->
    <div class="space-y-6 mt-6" th:if="${collectionTables != null}">
        <div class="bg-white rounded-lg shadow border border-gray-200" th:each="rel : ${collectionTables}">
            <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
                <div class="font-semibold">
                    <span th:text="${rel['name']}">relation</span>
                    <span class="text-gray-400">/</span>
                    <span class="text-gray-600" th:text="${rel['targetDisplayName']}">Target</span>
                </div>
                <div class="text-sm text-gray-500" th:if="${rel['totalCount'] != null}">
                    <span th:text="${rel['totalCount']}">0</span>
                    <span>items</span>
                    <span th:if="${rel['limited'] == true}"
                          class="ml-2 inline-flex items-center rounded bg-yellow-50 px-2 py-0.5 text-xs text-yellow-800 border border-yellow-200">showing first 100</span>
                </div>
            </div>
            <div class="p-4" th:if="${#lists.isEmpty(rel['rows'])}">
                <span class="text-sm text-gray-500">—</span>
            </div>
            <div class="overflow-x-auto" th:if="${!#lists.isEmpty(rel['rows'])}">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                    <tr>
                        <th scope="col"
                            class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                            th:each="attribute : ${rel['attributeTitles']}"
                            th:text="${attribute}">Attr
                        </th>
                    </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                    <tr class="hover:bg-gray-50 cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500"
                        th:each="row, rStat : ${rel['rows']}"
                        th:attr="data-href=${basePath + '/' + rel['targetEntity'] + '/' + rel['rowIds'][rStat.index]}"
                        tabindex="0" role="link">
                        <td class="px-4 py-3 text-sm text-gray-700" th:each="data, dStat : ${row}">
                            <span th:text="${data}">cell</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</body>
</html>
